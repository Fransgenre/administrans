import{d as V,r as y,o as d,c as n,F as _,a as b,w as v,b as s,t as f,e as m,f as h,v as g,g as x,h as I,i as w,j as D,k as $,l as P,m as C,u as U}from"./index-d3f47a0c.js";const k=V("global",{persist:{key:"store.global",paths:["profileIdx","profiles"]},state:()=>({profileIdx:0,profiles:[{}]}),getters:{currentProfile:i=>{let a=i.profiles[i.profileIdx];return a||{}}},actions:{persistProfileData(i){this.profiles[this.profileIdx]={...this.currentProfile,...i}}}}),B={key:0,class:"category"},F={key:1,class:"field"},S=["for"],E=["onUpdate:modelValue","id"],j={key:2,class:"checkbox"},q=["onUpdate:modelValue","id"],M=["for"],N=["type","onUpdate:modelValue","id"],O={__name:"DynamicForm",props:{structure:{type:Array,required:!0},modelValue:{type:Object,required:!0}},emits:["update:modelValue","submit"],setup(i){const a=i;k();const c={};a.structure.forEach(o=>{o.isInput&&(c[o.id]=o)});const r=y({...a.modelValue});return(o,l)=>(d(),n("form",{onSubmit:l[3]||(l[3]=v(()=>{},["prevent"])),class:"letter-form"},[(d(!0),n(_,null,b(a.structure,e=>(d(),n(_,{key:JSON.stringify(e)},[e.isCategory?(d(),n("div",B,[s("h2",null,f(e.name),1)])):m("",!0),e.isInput?(d(),n("div",F,[e.type!="checkbox"?(d(),n("label",{key:0,for:`field-${e.id}`},f(e.name),9,S)):m("",!0),e.type==="textarea"?h((d(),n("textarea",{key:1,"onUpdate:modelValue":t=>r[e.id]=t,id:`field-${e.id}`,rows:"3",onInput:l[0]||(l[0]=t=>o.$emit("update:modelValue",r))},`
        `,40,E)),[[g,r[e.id]]]):e.type==="checkbox"?(d(),n("div",j,[h(s("input",{type:"checkbox","onUpdate:modelValue":t=>r[e.id]=t,id:`field-${e.id}`,onChange:l[1]||(l[1]=t=>o.$emit("update:modelValue",r))},null,40,q),[[x,r[e.id]]]),s("label",{for:`field-${e.id}`},f(e.name),9,M)])):h((d(),n("input",{key:3,type:e.type||"text","onUpdate:modelValue":t=>r[e.id]=t,id:`field-${e.id}`,onInput:l[2]||(l[2]=t=>o.$emit("update:modelValue",r))},null,40,N)),[[I,r[e.id]]])])):m("",!0)],64))),128))],32))}},L={class:"hide-for-print"},T=s("hr",null,null,-1),A={class:"grid--row"},G={class:"grid--column hide-for-print"},J={class:"grid--column"},R={class:"hide-for-print"},z=s("h2",null,"Rendu du courrier",-1),H=["onClick"],K=s("hr",{class:"hidden"},null,-1),Q={class:"letter",id:"rendered"},W={__name:"LetterForm",props:{template:{type:Object,required:!0}},setup(i){const a=i,c=k(),r={};a.template.structure.forEach(t=>{if(t.isInput){let u;c.currentProfile[t.id]!=null?u=c.currentProfile[t.id]:t.default!=null&&(u=t.default()),r[t.id]=u}});const o=y(r);w(o,t=>{let u={};a.template.structure.forEach(p=>{(p.persist===void 0?!0:p.persist)&&t[p.id]!=null&&(u[p.id]=t[p.id])}),c.persistProfileData(u)},{deep:!0});function l(t){Object.assign(o,t)}function e(){window.print()}return(t,u)=>(d(),n("div",null,[s("div",L,[s("h1",null,f(i.template.name),1),s("p",null,f(i.template.description),1),T]),s("div",A,[s("div",G,[D(O,{modelValue:o,"onUpdate:modelValue":[u[0]||(u[0]=p=>o=p),l],structure:i.template.structure},null,8,["modelValue","structure"])]),s("div",J,[s("div",R,[z,s("button",{onClick:v(e,["prevent"])},"Télécharger au format PDF",8,H),K]),s("div",Q,[(d(),$(P(i.template.template),{data:o},null,8,["data"]))])])])]))}},Z={__name:"LetterView",props:{id:{type:String,required:!0}},setup(i){const a=i,c={};C.forEach(o=>{c[o.id]=o});const r=c[a.id];return(o,l)=>(d(),$(W,{template:U(r)},null,8,["template"]))}};export{Z as default};
