import{d as k,r as _,o as d,c as n,a as i,F as y,b as V,e as g,w as v,t as f,f as m,g as h,v as x,h as w,i as I,j as D,k as P,l as C,m as $,n as S,p as U,u as B}from"./index-a2239729.js";const b=k("global",{persist:{key:"store.global",paths:["profileIdx","profiles"]},state:()=>({profileIdx:0,profiles:[{}]}),getters:{currentProfile:r=>{let a=r.profiles[r.profileIdx];return a||{}}},actions:{persistProfileData(r){this.profiles[this.profileIdx]={...this.currentProfile,...r}}}}),F={class:"letter-form"},E={key:0,class:"category"},j={key:1,class:"field"},q=["for"],M=["onUpdate:modelValue","id"],N={key:2,class:"checkbox"},O=["onUpdate:modelValue","id"],L=["for"],R=["type","onUpdate:modelValue","id"],T={__name:"DynamicForm",props:{structure:{type:Array,required:!0},modelValue:{type:Object,required:!0}},emits:["update:modelValue","submit"],setup(r){const a=r;b();const c={};a.structure.forEach(s=>{s.isInput&&(c[s.id]=s)});const o=_({...a.modelValue});return(s,l)=>(d(),n("form",{onSubmit:l[3]||(l[3]=v(e=>s.$emit("submit"),["prevent"]))},[i("div",F,[(d(!0),n(y,null,V(a.structure,e=>(d(),n(y,{key:JSON.stringify(e)},[e.isCategory?(d(),n("h2",E,f(e.name),1)):m("",!0),e.isInput?(d(),n("div",j,[e.type!="checkbox"?(d(),n("label",{key:0,for:`field-${e.id}`},f(e.name),9,q)):m("",!0),e.type==="textarea"?h((d(),n("textarea",{key:1,"onUpdate:modelValue":t=>o[e.id]=t,id:`field-${e.id}`,rows:"3",onInput:l[0]||(l[0]=t=>s.$emit("update:modelValue",o))},`
          `,40,M)),[[x,o[e.id]]]):e.type==="checkbox"?(d(),n("div",N,[h(i("input",{type:"checkbox","onUpdate:modelValue":t=>o[e.id]=t,id:`field-${e.id}`,onChange:l[1]||(l[1]=t=>s.$emit("update:modelValue",o))},null,40,O),[[w,o[e.id]]]),i("label",{for:`field-${e.id}`},f(e.name),9,L)])):h((d(),n("input",{key:3,type:e.type||"text","onUpdate:modelValue":t=>o[e.id]=t,id:`field-${e.id}`,onInput:l[2]||(l[2]=t=>s.$emit("update:modelValue",o))},null,40,R)),[[I,o[e.id]]])])):m("",!0)],64))),128))]),g(s.$slots,"default")],32))}},z={class:"grid--row"},A={class:"grid--column hide-for-print"},G=i("p",null,"Remplissez le formulaire ci-dessous pour obtenir votre courrier.",-1),J=["onClick"],H={class:"grid--column"},K=i("div",{class:"hide-for-print"},[i("h2",null,"Rendu du courrier"),i("hr",{class:"hidden"})],-1),Q={class:"letter",id:"rendered",contenteditable:"true"},W={__name:"LetterForm",props:{template:{type:Object,required:!0}},setup(r){const a=r,c=b(),o={};a.template.structure.forEach(t=>{if(t.isInput){let u;c.currentProfile[t.id]!=null?u=c.currentProfile[t.id]:t.default!=null&&(u=t.default()),o[t.id]=u}});const s=_(o);D(s,t=>{let u={};a.template.structure.forEach(p=>{(p.persist===void 0?!0:p.persist)&&t[p.id]!=null&&(u[p.id]=t[p.id])}),c.persistProfileData(u)},{deep:!0});function l(t){Object.assign(s,t)}function e(){window.print()}return(t,u)=>(d(),n("div",null,[i("div",z,[i("div",A,[i("h1",null,f(r.template.name),1),G,P(T,{class:"position--sticky",modelValue:s,"onUpdate:modelValue":[u[0]||(u[0]=p=>s=p),l],structure:r.template.structure},{default:C(()=>[i("button",{type:"submit",class:"my-2",onClick:v(e,["prevent"])},"Télécharger au format PDF",8,J)]),_:1},8,["modelValue","structure"])]),i("div",H,[K,i("div",Q,[(d(),$(S(r.template.template),{data:s},null,8,["data"]))])])])]))}},Z={__name:"LetterView",props:{id:{type:String,required:!0}},setup(r){const a=r,c={};U.forEach(s=>{c[s.id]=s});const o=c[a.id];return(s,l)=>(d(),$(W,{template:B(o)},null,8,["template"]))}};export{Z as default};
